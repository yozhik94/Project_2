## Описание проекта
### Модель кредитного риск-менеджмента банка
Банки используют модели кредитного риск-менеджмента, чтобы понимать, насколько можно доверять клиенту в выполнении обязательств по договорамкредитования. Когда вы как клиент заполняете заявку на кредит или ипотеку,
вас оценивают по модели кредитного риск-менеджмента. Банк может использовать разные сведения: например, о месте работы, возрасте, истории предыдущих погашений по другим кредитам в банках и кредитных
организациях. На основе этой информации модель машинного обучения подсказывает кредитному менеджеру, стоит ли вам доверять запрашиваемую сумму денег.

С помощью такой автоматизации банк экономит время своих специалистов, чтобы они не искали и не агрегировали информацию по каждому клиенту для принятия решения о выдаче кредита. Это ускоряет время подтверждения
заявки на кредит. Однако в отдельных случаях специалисты могут экспертно проверить решение модели, чтобы проаудировать её и выявить возможные слабые места.

В рамках проекта решается востребованная задача — оцените риск неуплаты клиента по кредиту (дефолт).

Дефолт — неуплата процентов по кредиту или облигациям, непогашение займа в течение определённого времени t. Обычно дефолт считают свершившимся, если клиент не совершил выплату по кредиту в течение 90 дней.

### Описание данных

Данные содержат информацию о различных атрибутах заёмщиков и кредитных продуктов: о клиентах, которые уже имеют кредиты, их кредитной истории и финансовых показателях. Каждая запись в датасетепредставляет один
конкретный кредитный продукт, выданный конкретному заёмщику. Предложенные для пректа данные относятся к Big Data - большие данные. Данные собраны по кредитным продуктам **3 миллионов** клиентов за 2 года. 

### Атрибуты данных
* id — идентификатор заявки. Заявки пронумерованы так, что большему номеру соответствует более поздняя дата заявки.
* rn — порядковый номер кредитного продукта в кредитной истории. Большему номеру соответствует продукт с более поздней датой открытия.
* pre_since_opened — количество дней с даты открытия кредита до даты сбора данных (бинаризовано*).
* pre_since_confirmed — количество дней с даты подтверждения информации по кредиту до даты сбора данных (бинаризовано*).
* pre_pterm — плановое количество дней с даты открытия кредита до даты закрытия (бинаризовано*).
* pre_fterm — фактическое количество дней с даты открытия кредита до даты закрытия (бинаризовано*).
* pre_till_pclose	— плановое количество дней с даты сбора данных до даты закрытия кредита (бинаризовано*).
* pre_till_fclose	— фактическое количество дней с даты сбора данных до даты "открытия кредита (бинаризовано*).
* pre_loans_credit_limit	 — кредитный лимит (бинаризовано*).
* pre_loans_next_pay_summ — сумма следующего платежа по кредиту (бинаризовано*).
* pre_loans_outstanding — оставшаяся невыплаченная сумма кредита (бинаризовано*).
* pre_loans_total_overdue — текущая просроченная "адолженность (бинаризовано*).
* pre_loans_max_overdue_sum — максимальная просроченная задолженность (бинаризовано*).
* pre_loans_credit_cost_rate — полная стоимость кредита (бинаризовано*).
* pre_loans5 — число просрочек до 5 дней (бинаризовано*).
* pre_loans530 — число просрочек от 5 до 30 дней (бинаризовано*).
* pre_loans3060 — число просрочек от 30 до 60 дней (бинаризовано*).
* pre_loans6090 — число просрочек от 60 до 90 дней (бинаризовано*).
* pre_loans90 — число просрочек более чем на 90 дней (бинаризовано*).
* is_zero_loans_5 — флаг: нет просрочек до 5 дней.
* is_zero_loans_530 — флаг: нет просрочек от 5 до 30 дней.
* is_zero_loans_3060 — флаг: нет просрочек от 30 до 60 дней.
* is_zero_loans_6090 — флаг: нет просрочек от 60 до 90 дней.
* is_zero_loans90 — флаг: нет просрочек более чем на 90 дней.
* pre_util — отношение оставшейся невыплаченной суммы кредита к кредитному лимиту (бинаризовано*).
* pre_over2limit	— отношение текущей просроченной задолженности к кредитному лимиту (бинаризовано*).
* pre_till_pclose	— плановое количество дней с даты сбора данных до даты закрытия кредита (бинаризовано*).
* pre_till_fclose	— фактическое количество дней с даты сбора данных до даты закрытия кредита (бинаризовано*).
* pre_loans_credit_limit	 — кредитный лимит (бинаризовано*).
* pre_loans_next_pay_summ — сумма следующего платежа по кредиту (бинаризовано*).
* pre_loans_outstanding — оставшаяся невыплаченная сумма кредита (бинаризовано*).
* pre_loans_total_oÜerdue — текущая просроченная "задолженность (бинаризовано*).
* pre_loans_max_oÜerdue_sum — максимальная просроченная задолженность (бинаризовано*).
* pre_loans_credit_cost_rate — полная стоимость кредита (бинаризовано*).
* pre_loans5 — число просрочек до 5 дней (бинаризовано*).
* pre_loans530 — число просрочек от 5 до 30 дней (бинаризовано*).
* pre_loans3060 — число просрочек от 30 до 60 дней (бинаризовано*).
* pre_loans6090 — число просрочек от 60 до 90 дней (бинаризовано*).
* pre_loans90 — число просрочек более чем на 90 дней (бинаризовано*).
* is_zero_loans_5 — флаг: нет просрочек до 5 дней.
* is_zero_loans_530 — флаг: нет просрочек от 5 до 30 дней.
* is_zero_loans_3060 — флаг: нет просрочек от 30 до 60 дней.
* is_zero_loans_6090 — флаг: нет просрочек от 60 до 90 дней.
* is_zero_loans90 — флаг: нет просрочек более чем на 90 дней.
* pre_util — отношение оставшейся невыплаченной суммы кредита к кредитному лимиту (бинаризовано*).
* pre_over2limit	— отношение текущей просроченной "адолженности к кредитному лимиту (бинаризовано*).
* pre_maxover2limit — отношение максимальной просроченной задолженности к кредитному лимиту (бинаризовано*).
* is_zero_util — флаг: отношение оставшейся невыплаченной суммы кредита к кредитному лимиту равно 0.
* is_zero_over2limit — флаг: отношение текущей просроченной задолженности к кредитному лимиту равно 0.
* is_zero_maxover2limit — флаг: отношение максимальной просроченной задолженности к кредитному лимиту равно 0.
* enc_paym_{0..N} — статусы ежемесячных платежей за последние N месяцев (закодировано**).
* enc_loans_account_holder_type — тип отношения к кредиту (закодировано**).
* enc_loans_credit_status — статус кредита (закодировано**).
* enc_loans_account_cur — валюта кредита (закодировано**).
* enc_loans_credit_type — тип кредита (закодировано**).
* pclose_flag — флаг: плановое количество дней с даты открытия кредита до даты закрытия не определено.
* fclose_flag — флаг: фактическое количество дней с даты открытия кредита до даты закрытия не определено.
* Область значений поля разбивается на N непересекающихся промежутков. Каждому промежутку случайным образом назначается уникальный номер

от 0 до N-1E а значение поля заменяется номером промежуткаE которому оно принадлежит*

### Использованные библиотеки
Pandas NumPy Matplotliib Imbalanced-learn CatBoost PySpark Plotly Shap

### Выводы

Проведен анализ данных и также предобработка данных, в ходе которой кодированны категориальные признаки.

Для обработка больших массивов данных и инжиниринг признаков использовала PySpark. Для оптимизации оперативной памяти значения признаков преобразованы в формат int8.

Данные сильно дисбалансированы по целевой переменной. Дисбалансированными называется данные, в которой мощности классов целевой переменной значительно различаются. 

"Степень дисбаланса" (imbalance ratio) - отношение мощностей "маленького" (minor) и "большого" (major) классов.
В данном проекте "степень дисбаланса" составляет  1:28, то есть доля клиентов допустивших дифолт составляет 3,5%:

- класс minor (значение целевой переменной 1) - клиены допустившие дифолт по кредиту;

- класс major (значение целевой переменной 0) - клиены не допустившие дифолт по кредиту.

В проекте использовались два варианта использования  данных в модели:
1. Использовались все данные (с большим дисбалансом по целевой переменной);
2. Предварительно применили метод undersampling
  
### Результат на отложенных данных

|1. undersampling|TN(класс 0)|FN(класс 0)|2. без undersampling|TN(класс 0)|FN(класс 0)|
|---|---|---|---|---|---|
|   |8049|1577|   |174365|66010|
|   |3442|6183|   |225  |9400 |
|   |FP(класс 1)|TP(класс 1)|   |FP(класс 1)|TP(класс 1)|









